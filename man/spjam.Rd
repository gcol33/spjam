% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/spjam.R
\name{spjam}
\alias{spjam}
\title{Fit a Preferential Sampling Model}
\usage{
spjam(
  formula,
  sampling = NULL,
  data,
  locations,
  family = spjam_family("poisson"),
  spatial = spatial_gp(),
  sampling_spatial = NULL,
  shared = latent_shared(),
  priors = spjam_priors(),
  backend = c("hmc", "laplace", "auto"),
  chains = 4,
  iter = 2000,
  warmup = iter/2,
  thin = 1,
  cores = 1,
  seed = NULL,
  init = "default",
  control = list(),
  ...
)
}
\arguments{
\item{formula}{A formula or \code{spjam_formula} object specifying the
ecological process model.}

\item{sampling}{A formula specifying the sampling process model. If NULL,
uses an intercept-only LGCP.}

\item{data}{A data frame containing the response and covariates.}

\item{locations}{A matrix, sf object, or formula specifying observation
locations. Required for continuous spatial models.}

\item{family}{A \code{spjam_family} object specifying the response
distribution. Default is \code{spjam_family("poisson")}.}

\item{spatial}{Spatial structure specification. See \code{\link{spatial_gp}},
\code{\link{spatial_spde}}, etc.}

\item{sampling_spatial}{Spatial structure for sampling process. If NULL,
inherits from \code{spatial}.}

\item{shared}{Shared latent structure specification. See
\code{\link{latent_shared}}.}

\item{priors}{Prior specifications. See \code{\link{spjam_priors}}.}

\item{backend}{Inference backend: \code{"hmc"} (default), \code{"laplace"},
or \code{"auto"}.}

\item{chains}{Number of MCMC chains. Default 4.}

\item{iter}{Number of iterations per chain. Default 2000.}

\item{warmup}{Number of warmup iterations. Default \code{iter / 2}.}

\item{thin}{Thinning interval. Default 1.}

\item{cores}{Number of cores for parallel chains. Default 1.}

\item{seed}{Random seed for reproducibility.}

\item{init}{Initial values: \code{"default"}, \code{"random"}, or a list.}

\item{control}{A list of control parameters for the sampler.}

\item{...}{Additional arguments passed to backend.}
}
\value{
An object of class \code{spjam_fit} containing:
\item{draws}{Posterior samples}
\item{formula}{Model specification}
\item{sampling_formula}{Sampling process specification}
\item{family}{Distribution family}
\item{data}{Original data}
\item{locations}{Observation locations}
\item{backend}{Inference backend used}
\item{diagnostics}{MCMC diagnostics}
\item{decomposition}{Ecological/sampling/shared decomposition}
}
\description{
Jointly models an ecological spatial process and sampling intensity to
separate ecological signal from sampling-driven scatter.
}
\examples{
\donttest{
set.seed(42)
n <- 30
dat <- data.frame(
  abundance = rpois(n, exp(1.5)),
  elevation = rnorm(n),
  x = runif(n, 0, 5),
  y = runif(n, 0, 5)
)
fit <- spjam(
  abundance ~ elevation,
  data = dat,
  locations = ~ x + y,
  backend = "laplace",
  control = list(max_outer_iter = 5, n_samples = 50, verbose = FALSE)
)
print(fit)
}
}
